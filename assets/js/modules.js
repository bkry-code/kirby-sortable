!function(e){function t(i){if(s[i])return s[i].exports;var o=s[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}();!function(e){var t=0,o=function(){function o(i){var r=this;s(this,o),this.element=e(i),this.modules=e(".module",i),this.api=this.element.data("api"),this.shift=!1,this.strg=!1,console.log(this.modules),console.log(t),t++,this.element._sortable({handle:".module__preview, .module__title",start:function(){r.element._sortable("refreshPositions"),r.modules.removeClass("is-selected")}}),this.events()}return i(o,[{key:"events",value:function(){var t=this;this.element.on("_sortableupdate",function(e,s){var i=t.element.children().index(s.item),o=s.item.data("uid");t.sort(o,i)}),this.element.on("click","[data-action]",function(s){s.preventDefault(),e.post(e(s.target).data("action"),t.reload.bind(t)),console.log(e(s.target).data("action"))}),this.modules.on("click",function(s){t.select(e(s.delegateTarget))}),e(document).off(".modules").on("keydown.modules",function(e){switch(e.keyCode){case 16:if(t.shift)return!0;t.shift=!0;break;case 17:if(t.strg)return!0;t.strg=!0;break;case 67:if(!e.metaKey&&!e.ctrlKey)return!0;t.modules.hasClass("is-selected")&&app.modal.open("http://www.kirby.dev/panel/pages/home/field/sections/modules/copy");break;case 86:if(!e.metaKey&&!e.ctrlKey)return!0;t.modules.hasClass("is-selected")&&app.modal.open("http://www.kirby.dev/panel/pages/home/field/sections/modules/paste")}}).on("keyup.modules",function(e){switch(e.keyCode){case 16:console.log("shift false"),t.shift=!1;break;case 17:console.log("strg false"),t.strg=!1}}).on("click.modules",function(s){e(s.target).closest(".module").length||t.modules.removeClass("is-selected")})}},{key:"select",value:function(t){e(".form input:focus, .form select:focus, .form textarea:focus").blur(),app.content.focus.forget(),this.shift&&this.strg||this.shift||(this.strg?t.toggleClass("is-selected"):(this.modules.removeClass("is-selected"),t.addClass("is-selected")))}},{key:"sort",value:function(t,s){this.disable(),e.post(this.api+"/sort",{uid:t,to:s+1},this.reload.bind(this))}},{key:"disable",value:function(){this.element._sortable("disable")}},{key:"reload",value:function(){this.disable(),app.content.reload()}}]),o}();e.widget("ui._sortable",e.ui.sortable,{_mouseStart:function(t,s,i){var o,r,n=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this._createPlaceholder(),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),n.containment&&this._setContainment(),n.cursor&&"auto"!==n.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",n.cursor),this.storedStylesheet=e("<style>*{ cursor: "+n.cursor+" !important; }</style>").appendTo(r)),n.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",n.opacity)),n.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",n.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(o=this.containers.length-1;o>=0;o--)this.containers[o]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0}}),e.fn.modules=function(){return this.each(function(){if(e(this).data("modules"))return e(this);var t=new o(this);return e(this).data("modules",t),e(this)})}}(jQuery)}]);